---
layout: default
title: Standard library
parent: Autogenerated documentation
grand_parent: Existing models
nav_order: 5
---

# The Mobius2 standard library

This is auto-generated documentation based on the Mobius2 standard library in [Mobius2/stdlib](https://github.com/NIVANorge/Mobius2/blob/main/stdlib) .

The standard library provides common functions and constants for many models.

The file was generated at 2024-04-19 12:22:26.

---

## Meteorology

File: [stdlib/atmospheric.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/atmospheric.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Specific heat capacity of air | C_air | J kg⁻¹ K⁻¹ |
| Specific heat capacity of moist air | C_moist_air | kJ kg⁻¹ K⁻¹ |
| Molar ratio to mass ratio of vapor in air | vapor_mol_to_mass |  |
| Specific gas constant of dry air | Rdry_air | J kg⁻¹ K⁻¹ |
| Specific gas constant of vapor | Rvap_air | J kg⁻¹ K⁻¹ |

### Library functions

**latent_heat_of_vaporization**(T : °C) = 

$$
2.501 \mathrm{MJ}\,\mathrm{kg}^{-1}\,-0.002361 \mathrm{MJ}\,\mathrm{kg}^{-1}\,\mathrm{°C}^{-1}\,\cdot \mathrm{T}
$$

**mean_barometric_pressure**(elevation : m) = 

$$
\mathrm{elev} = \left(\mathrm{elevation}\Rightarrow 1\right) \\ \left(101.3-\left(0.01152-5.44e-07\cdot \mathrm{elev}\right)\cdot \mathrm{elev}\Rightarrow \mathrm{kPa}\,\right)
$$

**air_density**(temp : °C, pressure : hPa, a_vap : hPa) = 

$$
\mathrm{tk} = \left(\mathrm{temp}\rightarrow \mathrm{K}\,\right) \\ \left(\frac{\mathrm{pressure}-\mathrm{a\_vap}}{\mathrm{tk}\cdot \mathrm{Rdry\_air}}+\frac{\mathrm{a\_vap}}{\mathrm{tk}\cdot \mathrm{Rvap\_air}}\rightarrow \mathrm{kg}\,\mathrm{m}^{-3}\,\right)
$$

**psychrometric_constant**(pressure : kPa, lvap : MJ kg⁻¹) = 

$$
\left(\mathrm{C\_moist\_air}\rightarrow \mathrm{MJ}\,\mathrm{kg}^{-1}\,\mathrm{K}^{-1}\,\right)\cdot \frac{\mathrm{pressure}}{\mathrm{vapor\_mol\_to\_mass}\cdot \mathrm{lvap}}
$$

**saturation_vapor_pressure**(T : °C) = 

$$
\mathrm{t} = \left(\mathrm{T}\Rightarrow 1\right) \\ \left(6.1078+\mathrm{t}\cdot \left(0.443652+\mathrm{t}\cdot \left(0.0142895+\mathrm{t}\cdot \left(0.000265065+\mathrm{t}\cdot \left(3.03124e-06+\mathrm{t}\cdot \left(2.03408e-08+\mathrm{t}\cdot 6.13682e-11\right)\right)\right)\right)\right)\Rightarrow \mathrm{hPa}\,\right)
$$

**slope_of_saturation_pressure_curve**(T : °C, svap : kPa) = 

$$
\mathrm{tk} = \left(\mathrm{T}\rightarrow \mathrm{K}\,\right) \\ \frac{\mathrm{svap}}{\mathrm{tk}}\cdot \left(\frac{6790.5 \mathrm{K}\,}{\mathrm{tk}}-5.028\right)
$$

**dew_point_temperature**(vapor_pressure : hPa) = 

$$
34.07 \mathrm{K}\,+\frac{4157 \mathrm{K}\,}{\mathrm{ln}\left(\frac{2.1718e+08 \mathrm{hPa}\,}{\mathrm{vapor\_pressure}}\right)}
$$

**specific_humidity_from_pressure**(total_air_pressure : hPa, vapor_pressure : hPa) = 

$$
\mathrm{mixing\_ratio} = \mathrm{vapor\_mol\_to\_mass}\cdot \frac{\mathrm{vapor\_pressure}}{\mathrm{total\_air\_pressure}-\mathrm{vapor\_pressure}} \\ \frac{\mathrm{mixing\_ratio}}{1+\mathrm{mixing\_ratio}}
$$

---

## Radiation

File: [stdlib/atmospheric.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/atmospheric.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Solar constant | solar_constant | W m⁻² |

### Library functions

**solar_declination**(day_of_year : day) = 

$$
\mathrm{orbit\_rad} = \frac{2\cdot \pi\cdot \mathrm{day\_of\_year}}{365 \mathrm{day}\,} \\ 0.409\cdot \mathrm{sin}\left(\mathrm{orbit\_rad}-1.39\right)
$$

**hour_angle**(day_of_year : day, time_zone : hr, hour_of_day : hr, longitude : °) = 

$$
\mathrm{b} = 2\cdot \pi\cdot \frac{\mathrm{day\_of\_year}-81 \mathrm{day}\,}{365 \mathrm{day}\,} \\ \mathrm{eot} = \left(9.87\cdot \mathrm{sin}\left(2\cdot \mathrm{b}\right)-7.53\cdot \mathrm{cos}\left(\mathrm{b}\right)-1.5\cdot \mathrm{sin}\left(\mathrm{b}\right)\Rightarrow \mathrm{hr}\,\right) \\ \mathrm{lsmt} = 15 \mathrm{°}\,\mathrm{hr}^{-1}\,\cdot \mathrm{time\_zone} \\ \mathrm{ast} = \mathrm{hour\_of\_day}+\mathrm{eot}+\left(4 \mathrm{min}\,\mathrm{°}^{-1}\,\cdot \left(\mathrm{lsmt}-\mathrm{longitude}\right)\rightarrow \mathrm{hr}\,\right) \\ \mathrm{radians}\left(15 \mathrm{°}\,\mathrm{hr}^{-1}\,\cdot \left(\mathrm{ast}-12 \mathrm{hr}\,\right)\right)
$$

**cos_zenith_angle**(hour_a : , day_of_year : day, latitude : °) = 

$$
\mathrm{lat\_rad} = \mathrm{radians}\left(\mathrm{latitude}\right) \\ \mathrm{solar\_decl} = \mathrm{solar\_declination}\left(\mathrm{day\_of\_year}\right) \\ \mathrm{cz} = \mathrm{sin}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{sin}\left(\mathrm{solar\_decl}\right)+\mathrm{cos}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{cos}\left(\mathrm{solar\_decl}\right)\cdot \mathrm{cos}\left(\mathrm{hour\_a}\right) \\ \mathrm{max}\left(0,\, \mathrm{cz}\right)
$$

**refract**(cos_z, index) = 

$$
\sqrt{1-\frac{1-\mathrm{cos\_z}^{2}}{\mathrm{index}^{2}}}
$$

**daily_average_extraterrestrial_radiation**(latitude : °, day_of_year : day) = 

$$
\mathrm{orbit\_rad} = \frac{2\cdot \pi\cdot \mathrm{day\_of\_year}}{365 \mathrm{day}\,} \\ \mathrm{lat\_rad} = \mathrm{radians}\left(\mathrm{latitude}\right) \\ \mathrm{solar\_decl} = \mathrm{solar\_declination}\left(\mathrm{day\_of\_year}\right) \\ \mathrm{sunset\_hour\_angle} = \mathrm{acos}\left(-\mathrm{tan}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{tan}\left(\mathrm{solar\_decl}\right)\right) \\ \mathrm{inv\_rel\_dist\_earth\_sun} = 1+0.033\cdot \mathrm{cos}\left(\mathrm{orbit\_rad}\right) \\ \frac{\mathrm{solar\_constant}}{\pi}\cdot \mathrm{inv\_rel\_dist\_earth\_sun}\cdot \left(\mathrm{sunset\_hour\_angle}\cdot \mathrm{sin}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{sin}\left(\mathrm{solar\_decl}\right)+\mathrm{cos}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{cos}\left(\mathrm{solar\_decl}\right)\cdot \mathrm{sin}\left(\mathrm{sunset\_hour\_angle}\right)\right)
$$

**hourly_average_radiation**(daily_avg_rad : W m⁻², day_of_year : day, latitude : °, hour_angle : ) = 

$$
\mathrm{lat\_rad} = \mathrm{radians}\left(\mathrm{latitude}\right) \\ \mathrm{solar\_decl} = \mathrm{solar\_declination}\left(\mathrm{day\_of\_year}\right) \\ \mathrm{sunset\_hour\_angle} = \mathrm{acos}\left(-\mathrm{tan}\left(\mathrm{lat\_rad}\right)\cdot \mathrm{tan}\left(\mathrm{solar\_decl}\right)\right) \\ \mathrm{cosshr} = \mathrm{cos}\left(\mathrm{sunset\_hour\_angle}\right) \\ \mathrm{factor} = \pi\cdot \frac{\mathrm{cos}\left(\mathrm{hour\_angle}\right)-\mathrm{cosshr}}{\mathrm{sin}\left(\mathrm{sunset\_hour\_angle}\right)-\mathrm{sunset\_hour\_angle}\cdot \mathrm{cosshr}} \\ \mathrm{daily\_avg\_rad}\cdot \mathrm{max}\left(0,\, \mathrm{factor}\right)
$$

**clear_sky_shortwave**(extrad : W m⁻², elev : m) = 

$$
\mathrm{extrad}\cdot \left(0.75+2e-05 \mathrm{m}^{-1}\,\cdot \mathrm{elev}\right)
$$

**downwelling_longwave**(air_temp : °C, a_vap : hPa, cloud : ) = 

$$
\mathrm{air\_t} = \left(\mathrm{air\_temp}\rightarrow \mathrm{K}\,\right) \\ \mathrm{dpt} = \mathrm{dew\_point\_temperature}\left(\mathrm{a\_vap}\right) \\ \mathrm{dew\_point\_depression} = \mathrm{dpt}-\mathrm{air\_t} \\ \mathrm{cloud\_effect} = \left(10.77\cdot \mathrm{cloud}^{2}+2.34\cdot \mathrm{cloud}-18.44\Rightarrow \mathrm{K}\,\right) \\ \mathrm{vapor\_effect} = 0.84\cdot \left(\mathrm{dew\_point\_depression}+4.01 \mathrm{K}\,\right) \\ \mathrm{eff\_t} = \mathrm{air\_t}+\mathrm{cloud\_effect}+\mathrm{vapor\_effect} \\ \mathrm{black\_body\_radiation}\left(\mathrm{eff\_t}\right)
$$

---

## Basic constants

File: [stdlib/physiochemistry.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/physiochemistry.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Earth surface gravity | grav | m s⁻² |

---

## Thermodynamics

File: [stdlib/physiochemistry.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/physiochemistry.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Ideal gas constant | ideal_gas | J K⁻¹ mol⁻¹ |
| Boltzmann constant | boltzmann | J K⁻¹ |
| Stefan-Boltzmann constant | stefan_boltzmann | W m⁻² K⁻⁴ |

### Library functions

**black_body_radiation**(T_kelvin) = 

$$
\mathrm{stefan\_boltzmann}\cdot \mathrm{T\_kelvin}^{4}
$$

**enthalpy_adjust_log10**(log10ref : , ref_T : K, T : K, dU : kJ mol⁻¹) = 

$$
\mathrm{du} = \left(\mathrm{dU}\rightarrow \mathrm{J}\,\mathrm{mol}^{-1}\,\right) \\ \mathrm{log10ref}-\frac{\mathrm{du}}{\mathrm{ideal\_gas}\cdot \mathrm{ln}\left(10\right)}\cdot \left(\frac{1}{\mathrm{T}}-\frac{1}{\mathrm{ref\_T}}\right)
$$

---

## Water utils

File: [stdlib/physiochemistry.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/physiochemistry.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Water density | rho_water | kg m⁻³ |
| Specific heat capacity of water | C_water | J kg⁻¹ K⁻¹ |
| Thermal conductivity of water | k_water | W m⁻¹ K⁻¹ |
| Refraction index of water | refraction_index_water |  |
| Refraction index of ice | refraction_index_ice |  |

### Library functions

**water_temp_to_heat**(V : m³, T : °C) = 

$$
\mathrm{V}\cdot \left(\mathrm{T}\rightarrow \mathrm{K}\,\right)\cdot \mathrm{rho\_water}\cdot \mathrm{C\_water}
$$

**water_heat_to_temp**(V : m³, heat : J) = 

$$
\left(\frac{\mathrm{heat}}{\mathrm{V}\cdot \mathrm{rho\_water}\cdot \mathrm{C\_water}}\rightarrow \mathrm{°C}\,\right)
$$

**water_density**(T : °C) = 

$$
\mathrm{dtemp} = \left(\mathrm{T}\rightarrow \mathrm{K}\,\right)-277.13 \mathrm{K}\, \\ \mathrm{rho\_water}\cdot \left(1-0.5\cdot 1.6509e-05 \mathrm{K}^{-2}\,\cdot \mathrm{dtemp}^{2}\right)
$$

**dynamic_viscosity_water**(T : K) = 

$$
2646.8 \mathrm{g}\,\mathrm{m}^{-1}\,\mathrm{s}^{-1}\,\cdot e^{\left(-0.0268\cdot \mathrm{T}\Rightarrow 1\right)}
$$

**kinematic_viscosity_water**(T : K) = 

$$
0.00285 \mathrm{m}^{2}\,\mathrm{s}^{-1}\,\cdot e^{\left(-0.027\cdot \mathrm{T}\Rightarrow 1\right)}
$$

---

## Diffusivity

File: [stdlib/physiochemistry.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/physiochemistry.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Molecular volume of air at surface pressure | molvol_air | cm³ mol⁻¹ |
| Molecular mass of air | molmass_air | g mol⁻¹ |
| Molecular volume of H2O vapour at surface pressure | molvol_h2o | cm³ mol⁻¹ |
| Molecular mass of H2O | molmass_h2o | g mol⁻¹ |

### Library functions

**molecular_diffusivity_of_compound_in_air**(mol_vol : cm³ mol⁻¹, mol_mass : g mol⁻¹, T : K) = 

$$
\mathrm{TT} = \left(\mathrm{T}\Rightarrow 1\right) \\ \mathrm{c0} = \sqrt[3]{\left(\mathrm{molvol\_air}\Rightarrow 1\right)}+\sqrt[3]{\left(\mathrm{mol\_vol}\Rightarrow 1\right)} \\ \mathrm{c} = \frac{\sqrt{\frac{1}{\left(\mathrm{molmass\_air}\Rightarrow 1\right)}+\frac{1}{\left(\mathrm{mol\_mass}\Rightarrow 1\right)}}}{\mathrm{c0}^{2}} \\ \left(1e-07\cdot \mathrm{c}\cdot \mathrm{TT}^{1.75}\Rightarrow \mathrm{m}^{2}\,\mathrm{s}^{-1}\,\right)
$$

**molecular_diffusivity_of_compound_in_water**(mol_vol : cm³ mol⁻¹, dynamic_viscosity : g m⁻¹ s⁻¹) = 

$$
\mathrm{dynv} = \left(\mathrm{dynamic\_viscosity}\Rightarrow 1\right) \\ \frac{1.326e-08 \mathrm{m}^{2}\,\mathrm{s}^{-1}\,}{\mathrm{dynv}^{1.14}\cdot \left(\mathrm{mol\_vol}\Rightarrow 1\right)^{0.589}}
$$

**diffusion_velocity_of_vapour_in_air**(wind : m s⁻¹) = 

$$
0.002\cdot \mathrm{wind}+0.003 \mathrm{m}\,\mathrm{s}^{-1}\,
$$

**transfer_velocity_of_CO2_in_water_20C**(wind : m s⁻¹) = 

$$
\mathrm{w} = \left(\mathrm{wind}\Rightarrow 1\right) \\ \left(\mathrm{expr}\Rightarrow \mathrm{cm}\,\mathrm{s}^{-1}\,\right)
$$

---

## Chemistry

File: [stdlib/physiochemistry.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/physiochemistry.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| O₂ molar mass | o2_mol_mass | g mol⁻¹ |
| C molar mass | c_mol_mass | g mol⁻¹ |
| N molar mass | n_mol_mass | g mol⁻¹ |
| P molar mass | p_mol_mass | g mol⁻¹ |
| NO₃ molar mass | no3_mol_mass | g mol⁻¹ |
| PO₄ molar mass | po4_mol_mass | g mol⁻¹ |
| Ca molar mass | ca_mol_mass | g mol⁻¹ |

### Library functions

**nc_molar_to_mass_ratio**(nc_molar : ) = 

$$
\mathrm{nc\_molar}\cdot \frac{\mathrm{n\_mol\_mass}}{\mathrm{c\_mol\_mass}}
$$

**pc_molar_to_mass_ratio**(pc_molar : ) = 

$$
\mathrm{pc\_molar}\cdot \frac{\mathrm{p\_mol\_mass}}{\mathrm{c\_mol\_mass}}
$$

**cn_molar_to_mass_ratio**(cn_molar : ) = 

$$
\mathrm{cn\_molar}\cdot \frac{\mathrm{c\_mol\_mass}}{\mathrm{n\_mol\_mass}}
$$

**cp_molar_to_mass_ratio**(cp_molar : ) = 

$$
\mathrm{cp\_molar}\cdot \frac{\mathrm{c\_mol\_mass}}{\mathrm{p\_mol\_mass}}
$$

---

## Basic

File: [stdlib/basic_math.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/basic_math.txt)

### Library functions

**safe_divide**(a, b) = 

$$
\mathrm{r} = \frac{\mathrm{a}}{\mathrm{b}} \\ \begin{cases}\mathrm{r} & \text{if}\;\mathrm{is\_finite}\left(\mathrm{r}\right) \\ 0 & \text{otherwise}\end{cases}
$$

**close**(a, b, tol) = 

$$
\mathrm{abs}\left(\mathrm{a}-\mathrm{b}\right)<\mathrm{tol}
$$

**clamp**(a, mn, mx) = 

$$
\mathrm{min}\left(\mathrm{max}\left(\mathrm{a},\, \mathrm{mn}\right),\, \mathrm{mx}\right)
$$

**radians**(a : °) = 

$$
\mathrm{a}\cdot \frac{\pi}{180 \mathrm{°}\,}
$$

---

## Response

File: [stdlib/basic_math.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/basic_math.txt)

### Library functions

**hl_to_rate**(hl) = 

$$
\frac{\mathrm{ln}\left(2\right)}{\mathrm{hl}}
$$

**rate_to_hl**(rate) = 

$$
\frac{\mathrm{ln}\left(2\right)}{\mathrm{rate}}
$$

**q10_adjust**(ref_rate, ref_temp : °C, temp : °C, q10 : ) = 

$$
\mathrm{ref\_rate}\cdot \mathrm{q10}^{\frac{\mathrm{temp}-\mathrm{ref\_temp}}{10 \mathrm{°C}\,}}
$$

**lerp**(x, x0, x1, y0, y1) = 

$$
\mathrm{t} = \frac{\mathrm{x}-\mathrm{x0}}{\mathrm{x1}-\mathrm{x0}} \\ \left(1-\mathrm{t}\right)\cdot \mathrm{y0}+\mathrm{t}\cdot \mathrm{y1}
$$

**s_curve**(x, x0, x1, y0, y1) = 

$$
\mathrm{t} = \frac{\mathrm{x}-\mathrm{x0}}{\mathrm{x1}-\mathrm{x0}} \\ \mathrm{tt} = \left(3-2\cdot \mathrm{t}\right)\cdot \mathrm{t}^{2} \\ \left(1-\mathrm{tt}\right)\cdot \mathrm{y0}+\mathrm{tt}\cdot \mathrm{y1}
$$

**tanh_curve**(x, th) = 

$$
0.5\cdot \left(1+\mathrm{tanh}\left(\mathrm{x}-\mathrm{th}\right)\right)
$$

**linear_response**(x, x0, x1, y0, y1) = 

$$
\begin{cases}\mathrm{y0} & \text{if}\;\mathrm{x}\leq \mathrm{x0} \\ \mathrm{y1} & \text{if}\;\mathrm{x}\geq \mathrm{x1} \\ \mathrm{lerp}\left(\mathrm{x},\, \mathrm{x0},\, \mathrm{x1},\, \mathrm{y0},\, \mathrm{y1}\right) & \text{otherwise}\end{cases}
$$

**s_response**(x, x0, x1, y0, y1) = 

$$
\begin{cases}\mathrm{y0} & \text{if}\;\mathrm{x}\leq \mathrm{x0} \\ \mathrm{y1} & \text{if}\;\mathrm{x}\geq \mathrm{x1} \\ \mathrm{s\_curve}\left(\mathrm{x},\, \mathrm{x0},\, \mathrm{x1},\, \mathrm{y0},\, \mathrm{y1}\right) & \text{otherwise}\end{cases}
$$

**step_response**(x, x0, x1, y0, y1, y2) = 

$$
\begin{cases}\mathrm{y0} & \text{if}\;\mathrm{x}\leq \mathrm{x0} \\ \mathrm{y1} & \text{if}\;\mathrm{x}\leq \mathrm{x1} \\ \mathrm{y2} & \text{otherwise}\end{cases}
$$

**wedge_response**(x, x0, x1, x2, y0, y1, y2) = 

$$
\begin{cases}\mathrm{y0} & \text{if}\;\mathrm{x}\leq \mathrm{x0} \\ \mathrm{y2} & \text{if}\;\mathrm{x}\geq \mathrm{x2} \\ \mathrm{lerp}\left(\mathrm{x},\, \mathrm{x0},\, \mathrm{x1},\, \mathrm{y0},\, \mathrm{y1}\right) & \text{if}\;\mathrm{x}\leq \mathrm{x1} \\ \mathrm{lerp}\left(\mathrm{x},\, \mathrm{x1},\, \mathrm{x2},\, \mathrm{y1},\, \mathrm{y2}\right) & \text{otherwise}\end{cases}
$$

**bump_response**(x, x0, x1, x2, y0, y1, y2) = 

$$
\begin{cases}\mathrm{y0} & \text{if}\;\mathrm{x}\leq \mathrm{x0} \\ \mathrm{y2} & \text{if}\;\mathrm{x}\geq \mathrm{x2} \\ \mathrm{s\_curve}\left(\mathrm{x},\, \mathrm{x0},\, \mathrm{x1},\, \mathrm{y0},\, \mathrm{y1}\right) & \text{if}\;\mathrm{x}\leq \mathrm{x1} \\ \mathrm{s\_curve}\left(\mathrm{x},\, \mathrm{x1},\, \mathrm{x2},\, \mathrm{y1},\, \mathrm{y2}\right) & \text{otherwise}\end{cases}
$$

---

## Air-sea

File: [stdlib/seawater.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/seawater.txt)

### Library functions

**surface_stability**(wind : m s⁻¹, water_temp : °C, air_temp : °C) = 

$$
\mathrm{ww} = \mathrm{wind}+1e-10 \mathrm{m}\,\mathrm{s}^{-1}\, \\ \mathrm{s0} = \left(0.25\cdot \frac{\mathrm{water\_temp}-\mathrm{air\_temp}}{\mathrm{ww}\cdot \mathrm{ww}}\Rightarrow 1\right) \\ \mathrm{s0}\cdot \frac{\mathrm{abs}\left(\mathrm{s0}\right)}{\mathrm{abs}\left(\mathrm{s0}\right)+0.01}
$$

**stab_modify**(wind : m s⁻¹, stab : ) = 

$$
\begin{cases}0 & \text{if}\;\mathrm{abs}\left(\mathrm{wind}\right)<0.001 \mathrm{m}\,\mathrm{s}^{-1}\, \\ 0.1+0.03\cdot \mathrm{stab}\cdot 0.9\cdot e^{4.8\cdot \mathrm{stab}} & \text{if}\;\mathrm{stab}<0\;\text{and}\;\mathrm{stab}>-3.3 \\ 0 & \text{if}\;\mathrm{stab}<0 \\ 1+0.63\cdot \sqrt{\mathrm{stab}} & \text{otherwise}\end{cases}
$$

**tc_latent_heat**(wind : m s⁻¹, stability : ) = 

$$
\mathrm{w} = \left(\mathrm{wind}\Rightarrow 1\right)+1e-12 \\ \mathrm{expr}\cdot 0.001\cdot \mathrm{stab\_modify}\left(\mathrm{wind},\, \mathrm{stability}\right)
$$

**tc_sensible_heat**(wind : m s⁻¹, stability : ) = 

$$
\mathrm{w} = \left(\mathrm{wind}\Rightarrow 1\right)+1e-12 \\ \mathrm{expr}\cdot 0.001\cdot \mathrm{stab\_modify}\left(\mathrm{wind},\, \mathrm{stability}\right)
$$

---

## Seawater

File: [stdlib/seawater.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/seawater.txt)

### Constants

| Name | Symbol | Unit |
| ---- | ------ | ---- |
| Ice formation temperature salinity dependence | fr_t_s | °C |

### Library functions

**ice_formation_temperature**(S : ) = 

$$
-\mathrm{S}\cdot \mathrm{fr\_t\_s}
$$

**seawater_dens_standard_mean**(T : °C) = 

$$
\mathrm{a0} = 999.843 \\ \mathrm{a1} = 0.0679395 \\ \mathrm{a2} = -0.00909529 \\ \mathrm{a3} = 0.000100169 \\ \mathrm{a4} = -1.12008e-06 \\ \mathrm{a5} = 6.53633e-09 \\ \mathrm{T68} = \left(\mathrm{T}\cdot 1.00024\Rightarrow 1\right) \\ \left(\mathrm{a0}+\left(\mathrm{a1}+\left(\mathrm{a2}+\left(\mathrm{a3}+\left(\mathrm{a4}+\mathrm{a5}\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\Rightarrow \mathrm{kg}\,\mathrm{m}^{-3}\,\right)
$$

**seawater_pot_dens**(T : °C, S : ) = 

$$
\mathrm{b0} = 0.824493 \\ \mathrm{b1} = -0.0040899 \\ \mathrm{b2} = 7.6438e-05 \\ \mathrm{b3} = -8.2467e-07 \\ \mathrm{b4} = 5.3875e-09 \\ \mathrm{c0} = -0.00572466 \\ \mathrm{c1} = 0.00010227 \\ \mathrm{c2} = -1.6546e-06 \\ \mathrm{d0} = 0.00048314 \\ \mathrm{T68} = \left(\mathrm{T}\cdot 1.00024\Rightarrow 1\right) \\ \mathrm{seawater\_dens\_standard\_mean}\left(\mathrm{T}\right)+\left(\left(\mathrm{b0}+\left(\mathrm{b1}+\left(\mathrm{b2}+\left(\mathrm{b3}+\mathrm{b4}\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{S}+\left(\mathrm{c0}+\left(\mathrm{c1}+\mathrm{c2}\cdot \mathrm{T68}\right)\cdot \mathrm{T68}\right)\cdot \mathrm{S}\cdot \sqrt{\mathrm{S}}+\mathrm{d0}\cdot \mathrm{S}^{2}\Rightarrow \mathrm{kg}\,\mathrm{m}^{-3}\,\right)
$$

**dynamic_viscosity_fresh_water**(T : °C) = 

$$
\mathrm{eta20} = 0.001002 \mathrm{Pa}\,\mathrm{s}\, \\ \mathrm{tm20} = 20 \mathrm{°C}\,-\mathrm{T} \\ \mathrm{lograt} = \frac{1.1709\cdot \mathrm{tm20}-0.001827 \mathrm{°C}^{-1}\,\cdot \mathrm{tm20}^{2}}{\mathrm{T}+89.93 \mathrm{°C}\,} \\ \mathrm{eta20}\cdot 10^{\mathrm{lograt}}
$$

**dynamic_viscosity_sea_water**(T : °C, S : ) = 

$$
\mathrm{eta\_t} = \mathrm{dynamic\_viscosity\_fresh\_water}\left(\mathrm{T}\right) \\ \mathrm{a} = \mathrm{lerp}\left(\mathrm{T},\, 5 \mathrm{°C}\,,\, 25 \mathrm{°C}\,,\, 0.000366,\, 0.001403\right) \\ \mathrm{b} = \mathrm{lerp}\left(\mathrm{T},\, 5 \mathrm{°C}\,,\, 25 \mathrm{°C}\,,\, 0.002756,\, 0.003416\right) \\ \mathrm{cl} = \mathrm{max}\left(0,\, \frac{\mathrm{S}-0.03}{1.805}\right) \\ \mathrm{clv} = \left(\mathrm{seawater\_pot\_dens}\left(\mathrm{T},\, \mathrm{S}\right)\cdot \mathrm{cl}\Rightarrow 1\right) \\ \mathrm{eta\_t}\cdot \left(1+\mathrm{a}\cdot \sqrt{\mathrm{clv}}+\mathrm{b}\cdot \mathrm{clv}\right)
$$

**diffusivity_in_water**(ref_diff, ref_T : °C, ref_S : , T : °C, S : ) = 

$$
\mathrm{ref\_diff}\cdot \frac{\mathrm{dynamic\_viscosity\_sea\_water}\left(\mathrm{ref\_T},\, \mathrm{ref\_S}\right)}{\mathrm{dynamic\_viscosity\_sea\_water}\left(\mathrm{T},\, \mathrm{S}\right)}\cdot \frac{\left(\mathrm{T}\rightarrow \mathrm{K}\,\right)}{\left(\mathrm{ref\_T}\rightarrow \mathrm{K}\,\right)}
$$

---

## Sea oxygen

File: [stdlib/seawater.txt](https://github.com/NIVANorge/Mobius2/tree/main/stdlib/seawater.txt)

### Library functions

**o2_saturation**(T : °C, S : ) = 

$$
\mathrm{T\_k} = \left(\left(\mathrm{T}\rightarrow \mathrm{K}\,\right)\Rightarrow 1\right) \\ \left(e^{-135.902+\frac{157570}{\mathrm{T\_k}}-\frac{6.64231e+07}{\mathrm{T\_k}^{2}}+\frac{1.2438e+10}{\mathrm{T\_k}^{3}}-\frac{8.62195e+11}{\mathrm{T\_k}^{4}}-\mathrm{S}\cdot \left(0.017674-\frac{10.754}{\mathrm{T\_k}}+\frac{2140.7}{\mathrm{T\_k}^{2}}\right)}\Rightarrow \mathrm{mmol}\,\mathrm{m}^{-3}\,\right)
$$

**o2_piston_velocity**(wind : m s⁻¹, temp : °C) = 

$$
\mathrm{wnd} = \left(\mathrm{wind}\Rightarrow 1\right) \\ \mathrm{T} = \left(\mathrm{temp}\Rightarrow 1\right) \\ \mathrm{k\_600} = 2.07+0.215\cdot \mathrm{wnd}^{1.7} \\ \mathrm{schmidt} = 1800.6-120.1\cdot \mathrm{T}+3.7818\cdot \mathrm{T}^{2}-0.047608\cdot \mathrm{T}^{3} \\ \left(\mathrm{k\_600}\cdot \frac{\mathrm{schmidt}}{600}^{-0.666}\Rightarrow \mathrm{cm}\,\mathrm{hr}^{-1}\,\right)
$$



{% include lib/mathjax.html %}

